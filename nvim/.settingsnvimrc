"------------------------------------------------------------------------------"
"                                      set                                     "
"------------------------------------------------------------------------------"
set encoding=utf-8
set hidden
set nobackup
set nowritebackup
set cmdheight=2
set updatetime=300
set shortmess+=c
if has("patch-8.1.1564")
  set signcolumn=number
else
  set signcolumn=yes
endif
set relativenumber number
set smarttab
set cindent
set tabstop=2
set shiftwidth=2
set termguicolors
set expandtab
set ignorecase smartcase hlsearch incsearch
set showmode
set numberwidth=1
set virtualedit=block
set lazyredraw
set laststatus=2
set title
set ruler
set cursorline
syntax enable
filetype plugin on

"------------------------------------------------------------------------------"
"                                    golang                                    "
"------------------------------------------------------------------------------"
let g:go_fmt_command = "goimports"


"------------------------------------------------------------------------------"
"                                 Theme and CoC                                "
"------------------------------------------------------------------------------"
let g:rainbow_active = 1
if (has('termguicolors'))
  set termguicolors
endif
let g:material_terminal_italics = 1
let g:material_theme_style = 'ocean'
colorscheme material
syntax on
" let g:oceanic_next_terminal_bold = 1
" let g:oceanic_next_terminal_italic = 1
" colorscheme OceanicNext
hi Normal guibg=NONE ctermbg=NONE
hi LineNr guibg=NONE ctermbg=NONE
hi SignColumn guibg=NONE ctermbg=NONE
hi EndOfBuffer guibg=NONE ctermbg=NONE
" augroup SyntaxSettings
"     autocmd!
"     autocmd BufNewFile,BufRead *.tsx set filetype=typescript
" augroup END

if isdirectory('./node_modules') && isdirectory('./node_modules/prettier')
  let g:coc_global_extensions += ['coc-prettier']
endif

if isdirectory('./node_modules') && isdirectory('./node_modules/eslint')
  let g:coc_global_extensions += ['coc-eslint']
endif


"------------------------------------------------------------------------------"
"                                      Vue                                     "
"------------------------------------------------------------------------------"
let g:vim_vue_plugin_load_full_syntax = 1
let g:vim_vue_plugin_use_scss = 1
let g:vim_vue_plugin_use_sass = 1
let g:vim_vue_plugin_use_typescript = 1
let g:vim_vue_plugin_has_init_indent = 1
let g:vim_vue_plugin_highlight_vue_attr = 1
let g:vim_vue_plugin_highlight_vue_keyword = 1
" let g:vim_vue_plugin_use_foldexpr = 1
let g:vim_vue_plugin_debug = 1

let g:vue_pre_processors = 'detect_on_enter'


" autocmd FileType vue syntax sync fromstart
" autocmd BufRead,BufNewFile *.vue setlocal filetype=vue.html.javascript.css


"------------------------------------------------------------------------------"
"                                     Folds                                    "
"------------------------------------------------------------------------------"
" Keep all folds open when a file is opened
augroup OpenAllFoldsOnFileOpen
    autocmd!
    autocmd BufRead * normal zR
augroup END

"------------------------------------------------------------------------------"
"                                   Markdown                                   "
"------------------------------------------------------------------------------"
autocmd! User GoyoEnter Limelight
autocmd! User GoyoLeave Limelight!
" disable header folding
let g:vim_markdown_folding_disabled = 1

" do not use conceal feature, the implementation is not so good
let g:vim_markdown_conceal = 0

" disable math tex conceal feature
let g:tex_conceal = ""
let g:vim_markdown_math = 1

" support front matter of various format
let g:vim_markdown_frontmatter = 1  " for YAML format
let g:vim_markdown_toml_frontmatter = 1  " for TOML format
let g:vim_markdown_json_frontmatter = 1  " for JSON format
augroup pandoc_syntax
    au! BufNewFile,BufFilePre,BufRead *.md set filetype=markdown.pandoc
augroup END
" do not close the preview tab when switching to other buffers
let g:mkdp_auto_close = 0

"------------------------------------------------------------------------------"
"                                     Netrw                                    "
"------------------------------------------------------------------------------"
let g:netrw_banner = 0


"------------------------------------------------------------------------------"
"                                   NERDTree                                   "
"------------------------------------------------------------------------------"
let g:WebDevIconsNerdTreeBeforeGlyphPadding = ""
let g:NERDTreeGitStatusShowIgnored = 1
let NERDTreeShowHidden = 1
let NERDTreeIgnore=['\.git$', '\.idea$', '\.vscode$', '\.history$']

" If another buffer tries to replace NERDTree, put it in the other window, and bring back NERDTree.
" autocmd BufEnter * if bufname('#') =~ 'NERD_tree_\d\+' && bufname('%') !~ 'NERD_tree_\d\+' && winnr('$') > 1 |
"     \ let buf=bufnr() | buffer# | execute "normal! \<C-W>w" | execute 'buffer'.buf | endif
